/* Launch_Linux.ipp
 * 
 * Author           : Alexander J. Yee
 * Date Created     : 01/01/2016
 * Last Modified    : 01/01/2016
 * 
 */

////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
#include <stdlib.h>
#include "PublicLibs/ConsoleIO/Label.h"
#include "PublicLibs/SystemLibs/Environment/Environment.h"
#include "Launch.h"
using namespace ymp;
////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
std::string build_command(const std::string& module){
    const auto& params = Environment::get_cmd_parameters();

    std::string str("\"");
    str += module;
    str += "\"";
    for (size_t c = 1; c < params.size(); c++){
        str += " \"";
        str += params[c];
        str += "\"";
    }
    return str;
}
////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
void launch(const char* name){
    Console::println();
    Console::println_labelc("Auto-Selecting", name);
    Console::println();

    std::string path = Environment::get_process_directory() + "Binaries/" + name;
    Console::println(path);
    Console::println("\n");

    Console::println("Launching y-cruncher...", 'Y');
    Console::println("================================================================\n", 'g');
    Console::set_color('w');

    int ret = system(build_command(path).c_str());
    Console::set_color_default();
    if (!Environment::RunFromConsole()){
        Console::pause();
    }
    exit(ret);
}
////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
