/* Double_Round.h
 * 
 *  Author          : Alexander J. Yee
 *  Date Created    : 05/10/2015
 *  Last Modified   : 05/10/2015
 * 
 *      Wrappers for rounding to integers.
 * 
 */

#pragma once
#ifndef ymp_Double_Rounding_H
#define ymp_Double_Rounding_H
////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
//  Dependencies
#include "PublicLibs/CompilerSettings.h"
#include "PublicLibs/Types.h"
#include "PublicLibs/SystemLibs/ProcessorCapability/ProcessorCapability.h"
////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
#if 0
#elif defined YMP_Arch_2004_x64
#include <emmintrin.h>
namespace ymp{
    YM_FORCE_INLINE s32_t round_s32(double x){
        return _mm_cvtsd_si32(_mm_set_sd(x));
    }
    YM_FORCE_INLINE s64_t round_s64(double x){
        return _mm_cvtsd_si64(_mm_set_sd(x));
    }
}
#elif defined YMP_Arch_2001_x86_SSE2
#include <cmath>
#include <emmintrin.h>
namespace ymp{
    YM_FORCE_INLINE s32_t round_s32(double x){
        return _mm_cvtsd_si32(_mm_set_sd(x));
    }
    YM_FORCE_INLINE s64_t round_s64(double x){
        return (s64_t)std::llrint(x);
    }
}
#else
#include <cmath>
namespace ymp{
    YM_FORCE_INLINE s32_t round_s32(double x){
        return (s32_t)std::lrint(x);
    }
    YM_FORCE_INLINE s64_t round_s64(double x){
        return (s64_t)std::llrint(x);
    }
}
#endif
////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
#endif
